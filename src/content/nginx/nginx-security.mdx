---
id: "nginx-security"
title: "Security Hardening üõ°Ô∏è"
guide: "nginx"
group: "Security & TLS"
linkRefs:
  - id: "owasp-secure-headers"
    note: "OWASP secure headers project"
---

<SectionTitle>{frontmatter.title}</SectionTitle>

<Toc>
  <TocLink id="toc-headers">Security headers & rate limiting</TocLink>
  <TocLink id="toc-allowlist">IP allowlisting</TocLink>
</Toc>

<SectionIntro>
Nginx sits at the front line of your infrastructure. Proper security configuration protects against common attacks and reduces your attack surface significantly.
</SectionIntro>

<SectionSubheading id="toc-headers">Security Headers & Rate Limiting</SectionSubheading>

```nginx
http {
    # Rate limiting ‚Äî prevent brute force & DDoS
    limit_req_zone $binary_remote_addr
        zone=general:10m rate=10r/s;
    limit_req_zone $binary_remote_addr
        zone=login:10m rate=1r/s;

    server {
        listen 443 ssl http2;
        server_name secure.example.com;

        # Security headers
        add_header X-Frame-Options "SAMEORIGIN" always;
        add_header X-Content-Type-Options "nosniff" always;
        add_header X-XSS-Protection "1; mode=block" always;
        add_header Referrer-Policy
            "strict-origin-when-cross-origin" always;
        add_header Content-Security-Policy
            "default-src 'self'; script-src 'self'" always;
        add_header Permissions-Policy
            "camera=(), microphone=(), geolocation=()" always;

        # Hide nginx version
        server_tokens off;

        # Apply rate limits
        location / {
            limit_req zone=general burst=20 nodelay;
            proxy_pass http://127.0.0.1:3000;
        }

        location /api/auth/login {
            limit_req zone=login burst=5;
            proxy_pass http://127.0.0.1:3000;
        }

        # Block common exploit paths
        location ~* /(wp-admin|wp-login|\.env|\.git) {
            deny all;
            return 404;
        }
    }
}
```

<Gotcha>
The rate limit `burst` parameter is a queue. With `burst=20 nodelay`, Nginx allows 20 excess requests to be served immediately but then enforces the rate. Without `nodelay`, excess requests are queued and delayed ‚Äî creating a smoother flow but higher latency.
</Gotcha>

<SectionSubheading id="toc-allowlist">IP Allowlisting (Admin Panels, Internal Tools)</SectionSubheading>

```nginx
# Only allow specific IPs to access admin
location /admin/ {
    # Allow your office/VPN
    allow 203.0.113.0/24;
    allow 10.0.0.0/8;
    deny all;

    proxy_pass http://127.0.0.1:4000/;
}

# Basic auth for staging environments
location / {
    auth_basic "Staging Environment";
    auth_basic_user_file /etc/nginx/.htpasswd;
    proxy_pass http://127.0.0.1:3000;
}

# Generate password file:
# sudo apt install apache2-utils
# sudo htpasswd -c /etc/nginx/.htpasswd username
```
