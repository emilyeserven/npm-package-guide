---
id: "zst-middleware"
title: "Middleware ðŸ”§"
guide: "zustand"
linkRefs:
  - id: "zst-docs"
    note: "Zustand middleware documentation"
  - id: "zst-immer"
    note: "Immer â€” immutable state with mutable syntax"
---

<SectionTitle>{frontmatter.title}</SectionTitle>

<Toc>
  <TocLink id="toc-persist">persist â€” Sync to Storage</TocLink>
  <TocLink id="toc-devtools">devtools â€” Redux DevTools</TocLink>
  <TocLink id="toc-immer">immer â€” Mutable-style Updates</TocLink>
  <TocLink id="toc-subscribe-sel">subscribeWithSelector</TocLink>
  <TocLink id="toc-stacking">Stacking Middleware</TocLink>
</Toc>

<SectionIntro>
Zustand middleware wraps the store creator to add functionality. Middleware is composable â€” you can stack as many as you need.
</SectionIntro>

<SectionSubheading id="toc-persist">persist â€” Sync to localStorage/sessionStorage</SectionSubheading>

<ZstCodeBlock exampleId="persist" />

<SectionNote>
**Persist + Migrations:** The persist middleware supports a `version` number and `migrate` function for handling schema changes across app updates. Essential for production apps.
</SectionNote>

<SectionSubheading id="toc-devtools">devtools â€” Redux DevTools integration</SectionSubheading>

<ZstCodeBlock exampleId="devtools" />

<SectionSubheading id="toc-immer">immer â€” Mutable-style updates</SectionSubheading>

<ZstCodeBlock exampleId="immer" />

<SectionSubheading id="toc-subscribe-sel">subscribeWithSelector â€” Fine-grained subscriptions</SectionSubheading>

<ZstCodeBlock exampleId="sub-with-sel" />

<SectionSubheading id="toc-stacking">Stacking Middleware</SectionSubheading>

Middleware composes by nesting. Order matters â€” outer middleware wraps inner middleware.

<ZstCodeBlock exampleId="stack-middleware" />

<SectionNote>
**Recommended middleware order (outside â†’ inside):** `devtools` â†’ `subscribeWithSelector` â†’ `persist` â†’ `immer`. This ensures DevTools captures everything, persist sees the immutable state, and immer is closest to your code.
</SectionNote>
