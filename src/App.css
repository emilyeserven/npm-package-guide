@import "tailwindcss";
@custom-variant dark (&:where(.dark, .dark *));

/* ── Theme: fonts only (colors use Tailwind built-in palette) ─────── */
@theme {
  --font-sans: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  --font-mono: 'JetBrains Mono', monospace;
}

/* ── Base ──────────────────────────────────────────────────────────── */
@layer base {
  body {
    @apply font-sans text-slate-900 dark:text-slate-100 bg-gray-50 dark:bg-slate-900;
    -webkit-font-smoothing: antialiased;
    transition: background 0.2s ease, color 0.2s ease;
  }
  sup {
    top: 0;
  }
}

/* ── Component classes ────────────────────────────────────────────── */
@layer components {
  /* Section intro — nested selectors only (base styles inlined in SectionIntro) */
  .section-intro strong { @apply text-slate-900 dark:text-slate-100 font-semibold; }
  .section-intro ul { @apply my-2.5 pl-5 list-none; }
  .section-intro ul li { @apply relative py-0.5 pl-2; }
  .section-intro ul li::before {
    content: '\2192';
    @apply absolute -left-4 text-blue-500 dark:text-blue-400 font-semibold;
  }


  [id^="toc-"] { scroll-margin-top: 68px; }

  /* ColItem — ::before only (base styles inlined in ColItem component) */
  .col-item::before {
    content: '\2022';
    @apply absolute left-0 text-gray-500 dark:text-slate-400 font-bold text-sm;
  }

  /* Code Block — descendant selectors only (base styles inlined in CodeBlock) */
  .code-block .comment { @apply text-slate-500; }
  .code-block .key { @apply text-sky-300; }
  .code-block .string { @apply text-green-300; }

  /* Roadmap — pseudo-elements and nested selectors only (base styles inlined in JSX) */
  .step-card:not(:last-child) .step-number::after {
    content: '';
    @apply absolute left-1/2 -translate-x-1/2 w-0.5 bg-blue-100 dark:bg-blue-500/20;
    top: 38px;
    height: calc(100% + 4px);
  }
  .step-detail code {
    @apply font-mono text-xs bg-slate-200 dark:bg-slate-700 px-1.5 py-px rounded-sm text-slate-900 dark:text-slate-100;
  }
  .bonus-number {
    background: linear-gradient(135deg, #f59e0b, #d97706) !important;
    font-size: 15px !important;
  }
  .bonus-step .step-number::after { display: none !important; }

  /* Accordion body — transition requires CSS */
  .accordion-body {
    max-height: 0;
    overflow: hidden;
    padding-left: var(--spacing-4_5, 1.125rem);
    padding-right: var(--spacing-4_5, 1.125rem);
    transition: max-height 0.3s ease, padding 0.3s ease;
    padding-top: 0;
    padding-bottom: 0;
  }
  .accordion-body.open {
    max-height: 2000px;
    padding-bottom: 16px;
  }

  /* CI tip — ::before only (base styles inlined in CITip component) */
  .ci-tip::before { content: '\1F4A1\0020'; }

  /* Good tests list — li child styles only (base styles inlined in GoodTestsList) */
  .good-tests-list li { @apply mb-2 leading-relaxed; }
  .good-tests-list li:last-child { @apply mb-0; }

  /* Footnote ref — needs CSS for element selector + hover + transition */
  sup.fn-ref {
    @apply text-xs font-bold text-white bg-blue-500 dark:bg-blue-400 dark:text-slate-900 rounded px-1 ml-0.5 cursor-pointer no-underline align-super leading-none;
    transition: background 0.15s;
  }
  sup.fn-ref:hover { @apply bg-blue-700 dark:bg-blue-500; }


  /* PM toggle commands */
  .cmd {
    @apply font-mono text-xs bg-slate-200 dark:bg-slate-700 px-1.5 rounded text-slate-900 dark:text-slate-100;
  }
  .cmd-pnpm { display: none; }
  .cmd-npm { display: inline; }

  /* Glossary term inline annotation (used in enriched HTML strings) */
  .glossary-term {
    @apply border-b border-dashed border-current cursor-help transition-[border-bottom-style] duration-150;
  }
  .glossary-term:hover { border-bottom-style: solid; }
}

/* ── Body-level toggle rules ──────────────────────────────────────── */
body.sidebar-open .sidebar-overlay {
  @apply opacity-100 pointer-events-auto;
}
body.sidebar-open .sidebar {
  translate: 0;
}
body.settings-open .settings-overlay {
  @apply opacity-100 pointer-events-auto;
}
body.pnpm .cmd-pnpm { display: inline; }
body.pnpm .cmd-npm { display: none; }

/* ── Command palette (cmdk) — attribute selectors for library-rendered elements ── */
[cmdk-input] {
  @apply w-full px-4 py-3 text-sm bg-transparent border-b border-slate-200 dark:border-slate-700 text-slate-900 dark:text-slate-100 outline-none;
}
[cmdk-input]::placeholder {
  @apply text-slate-400 dark:text-slate-500;
}
[cmdk-list] {
  @apply max-h-80 overflow-y-auto p-2;
}
[cmdk-item] {
  @apply flex items-center px-3 py-2 text-sm rounded-lg cursor-pointer text-slate-700 dark:text-slate-300 transition-colors duration-150;
}
[cmdk-item][data-selected="true"] {
  @apply bg-blue-50 dark:bg-blue-500/10 text-blue-600 dark:text-blue-400;
}
[cmdk-item]:active {
  @apply bg-blue-100 dark:bg-blue-500/20;
}
[cmdk-group-heading] {
  @apply text-xs font-semibold text-gray-400 dark:text-slate-500 uppercase tracking-wider px-3 py-1.5;
}
[cmdk-empty] {
  @apply py-6 text-center text-sm text-slate-500 dark:text-slate-400;
}

/* ── Animations ───────────────────────────────────────────────────── */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(6px); }
  to { opacity: 1; transform: translateY(0); }
}
